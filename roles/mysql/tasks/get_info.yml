---
- name: Restart service mysql
  ansible.builtin.service:
    name: mysqld
    state: restarted

- name: Flush privileges
  ansible.builtin.shell: mysql -e "FLUSH PRIVILEGES;"

- name: Change password root mysql
  ansible.builtin.shell: mysql -e "ALTER USER 'root'@'localhost' identified by '{{password | password_hash('sha512')}}';"

- name: Get version from MySQL
  community.mysql.mysql_info:
    #config_file: /root/.my.cnf
    filter:
      - version
  register: ms_version

- debug:
    var: ms_version.version.full

- name: Create a motd file with MySql version
  ansible.builtin.template:
    src: templates/motd
    dest: /etc/motd
